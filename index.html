<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="ReGround: Improving Textual and Spatial Grounding at No Cost">
  <meta name="keywords" content="ReGround, Diffusion models, Grounding">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
  <title>ReGround: Improving Textual and Spatial Grounding at No Cost</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-2 publication-title">ReGround: Improving Textual and Spatial Grounding at No Cost</h1>
          <div style="font-size:x-large;">ECCV 2024</div><br>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://phillipinseoul.github.io/">Phillip Y. Lee</a>,</span>
            <span class="author-block">
              <a href="https://mhsung.github.io/">Minhyuk Sung</a></span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">KAIST</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="./static/reground_paper.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2403.13589"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (Soon) </span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop has-text-centered">
    <p style="font-size: 125%;">
      tl;dr: <span class="dnerf">ReGround</span> resolves the issue of description omission in GLIGEN [1] while accurately reflecting the bounding boxes, 
      <b>without any extra cost</b>.
    </p>
  </div>
  <br><br>
  <div class="columns is-centered has-text-centered is-flex-direction-column">
    <div class="container" style="width:90%;">
      <img src="./static/images/qualitative/header.png" alt="header" style="max-width:80%;">
      <br>
      <img src="./static/images/qualitative/website_teaser.png" alt="comparison-01" style="max-width:80%;">
    </div>
    <br>
  </div>
</section><br><br>

<script>
   document.getElementById('vid_newyork').play();
</script>

<hr>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered is-flex-direction-column">
        <h2 class="title is-4">Abstract</h2>
        <div class="content has-text-justified">
          <p style="font-size: 110%;">
            <i>When an image generation process is guided by both a text prompt and spatial cues, such as a set of bounding boxes, 
            do these elements work in harmony, or does one dominate the other?</i>
            Our analysis of a pretrained image diffusion model that integrates 
            gated self-attention into the U-Net reveals that spatial grounding often outweighs textual grounding due to the sequential flow 
            from gated self-attention to cross-attention. We demonstrate that such bias can be significantly mitigated without sacrificing accuracy 
            in either grounding by simply rewiring the network architecture, changing from sequential to parallel for gated self-attention 
            and cross-attention. This surprisingly simple yet effective solution does not require any fine-tuning of the network but significantly 
            reduces the trade-off between the two groundings. Our experiments demonstrate significant improvements from the original GLIGEN 
            to the rewired version in the trade-off between textual grounding and spatial grounding.
          </p>
        </div>
      </div><br>

    <div class="container">
      <div class="content has-text-centered">
        <video id="“axe”" controls="" autoplay="" muted="" loop="" style="max-width:90%;">
          <source src="./static/reground_video.mp4">
        </video>
      </div>
    </div>
  </div>
</section>

<hr>

<section class="section">
  <div class="container is-max-desktop">
    <!-- <div class="column is-four-fifths"></div> -->
      <!-- Abstract. -->
    <div class="columns is-centered has-text-centered is-flex-direction-column">
      <h2 class="title is-4">Trade-off between Textual and Spatial Grounding</h2>
      <div class="container">
        <img src="./static/images/gligen_ablation.png" alt="Framework" style="max-width:90%;">
      </div>
      <div class="content has-text-justified">
        <p></p>
        <p style="font-size: 110%;">
          (a) Images generated by GLIGEN [1] while varying the activation duration of gated self-attention (&gamma;) in scheduled sampling (Sec. 5.1). 
          The <span style="color:crimson"><b>red</b></span> words in the text prompt denote the words used as labels of the input bounding boxes. 
          Note that to reflect the <u>underlined</u> description in the text prompt in the final image, &gamma; must be decreased to 0.1, 
          which compromises spatial grounding accuracy. (b) In contrast, our <span class="dnerf">ReGround</span> reflects the <u>underlined</u> phrase even when
           &gamma;=1.0, therefore achieving high accuracy in both textual and spatial grounding.
        </p>
      </div>
    </div>
  </div>
  <!--/ Abstract. -->
</section><hr>

<section class="section">
  <div class="container is-max-desktop">
    <!-- <div class="column is-four-fifths"></div> -->
      <!-- Abstract. -->
    <div class="columns is-centered has-text-centered is-flex-direction-column">
      <h2 class="title is-4">Impact of Cross-Attention on Spatial Grounding</h2>
      <div class="container">
        <img src="./static/images/cross_attention_ablation.png" alt="Framework" style="max-width:90%;">
      </div>
      <div class="content has-text-justified">
        <p></p>
        <p style="font-size: 110%;">
          Comparison of the output of GLIGEN [1] <i>with</i> and <i>without</i> cross-attention. 
          While the absence of cross-attention reduces realism and quality of the image, 
          the silhouette of objects remains grounded within the given bounding boxes, 
          as shown in the third column of each case.
        </p>
      </div>
    </div>
  </div>
</section><hr>

<section class="section">
  <div class="container is-max-desktop">
    <!-- <div class="column is-four-fifths"></div> -->
      <!-- Abstract. -->
    <div class="columns is-centered has-text-centered is-flex-direction-column">
      <h2 class="title is-4">Main Idea: Network Rewiring</h2>
      <div class="container">
        <img src="./static/images/main_pipeline_figure.png" alt="Framework" style="max-width:90%;">
      </div>
      <div class="content has-text-justified">
        <p></p>
        <p style="font-size: 110%;">
          Comparison between the U-Net architectures of (a) Latent Diffusion Model (LDM) [2], (b) GLIGEN [1]
           and (c) our <span class="dnerf">ReGround</span>. From LDM, GLIGEN enables spatial grounding by injecting 
           gated self-attention before cross-attention, forming a <i>sequential</i> flow of them. 
        </p>
        <p style="font-size: 110%;">
           Based on GLIGEN, 
           our <span class="dnerf">ReGround</span> changes the relationship of the two attention modules to become 
           <i>parallel</i>, resulting in noticeable improvement in textual grounding while preserving the spatial grounding 
           capability. (The residual block before self-attention is omitted.)
        </p>
      </div>
    </div>
  </div>
  <!--/ Abstract. -->

  <!--/ Abstract. -->
</section><hr>

<section class="hero teaser">
  <div class="columns is-centered has-text-centered is-flex-direction-column"><br>
    <h2 class="title is-4">Qualitative Comparisons</h2>
  </div>
  <div class="container is-max-desktop is-centered has-text-centered">
    <p style="font-size: 120%;"><span class="dnerf">ReGround</span> (last column) resolves the issue of <u>description omission</u>
      while accurately reflecting the bounding box information.</p>
  </div>
  <br><br>
  <div class="columns is-centered has-text-centered is-flex-direction-column">
    <div class="container" style="width:75%;">
      <img src="./static/images/qualitative/header.png" alt="header" style="max-width:80%;">
      <br>
      <img src="./static/images/qualitative/website_main_qualitative.png" alt="comparison-02" style="max-width:80%;">
    </div>
    <br>
    <span class="link-block">
      <a href="./gallery.html"
         class="external-link button is-normal is-rounded is-dark">
        <span>See More Results</span>
        <span class="icon">
          <i class="far fa-arrow-alt-circle-right	"></i>
        </span>
      </a>
    </span>
    <br>
  </div>
</section><br><br><hr>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>
      @article{lee2024reground,
        title={ReGround: Improving Textual and Spatial Grounding at No Cost},
        author={Lee, Phillip Y and Sung, Minhyuk},
        journal={arXiv preprint arXiv:2403.13589},
        year={2024}
      }
    </code></pre>
  </div>
</section><hr>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">Reference</h2>
    <p style="font-size: 110%;">
      [1] <a href="https://gligen.github.io/">GLIGEN: Open-Set Grounded Text-to-Image Generation</a>, Li <i>et al.</i>, CVPR 2023.
      <br>
      [2] <a href="https://arxiv.org/abs/2112.10752">High-Resolution Image Synthesis with Latent Diffusion Models</a>, Rombach <i>et al.</i>, CVPR 2022.
    </p>
  </div>
</section><hr>

<!-- <section class="section">
  <div class="container is-max-desktop content">
    <h2 class="title">Acknowledgements</h2>
    TODO.
  </div>
</section> -->

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            The website is based on <a href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>. We thank 
            <a href="https://keunhong.com/">Keunhong Park</a> for kindly open-sourcing the source code.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>